{"version":3,"sources":["src/swivel.js"],"names":[],"mappings":"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","file":"src/swivel.js","sourcesContent":["class Swivel {\n  constructor(images, options) {\n    let opts = options || {};\n    this.settings = {\n      containerSelector: opts.containerSelector || '#swivel',\n      startIndex: opts.startIndex || Math.round(images.length / 2) - 1,\n      height: opts.height || null,\n      width: opts.width || null,\n      maxAngle: Math.min(opts.maxAngle, 180) || 40,\n      smooth: (opts.smooth !== undefined) ? opts.smooth : true,\n      smoothInterval: opts.smoothInterval || 100,\n      callback: (typeof opts.callback === 'function') ? opts.callback : function(){},\n    };\n    this.images = this._preloadImages(images);\n    this.container = document.querySelector(this.settings.containerSelector);\n    this.displayedIndex = 0;\n  }\n\n  _preloadImages(images) {\n    // preload startIndex image first\n    let imgObj = new Image();\n    imgObj.src = images[this.settings.startIndex];\n    imgObj.onload = (e) => {\n      this._startImgLoaded = true;\n      this.settings.height = this.settings.height || e.target.height;\n      this.settings.width = this.settings.width || e.target.width;\n      if (this._runOnLoad) { this.run() };\n    };\n\n    let htmlImages = [];\n    for (let i = 0; i < images.length; i++) {\n      let imgObj = new Image()\n      imgObj.src = images[i];\n      imgObj.style.display = 'none';\n      htmlImages.push(imgObj);\n    }\n\n    return htmlImages;\n  }\n\n  transitionToImage(index) {\n    if (index == this._targetIndex) { return; }\n    this._targetIndex = index;\n    clearTimeout(this._intervalTimeout);\n\n    if (!this.settings.smooth) {\n      this._setImage(index);\n      return;\n    }\n\n    let transitionFunc = () => {\n      if (this.displayedIndex == this._targetIndex) { return; }\n      if (this.displayedIndex > this._targetIndex) {\n        this._setImage(this.displayedIndex - 1);\n      } else {\n        this._setImage(this.displayedIndex + 1);\n      }\n      this._intervalTimeout = setTimeout(transitionFunc, this.settings.smoothInterval);\n    }\n    transitionFunc();\n  }\n\n  _setImage(index) {\n    this.images[index].style.display = null;\n    this.images[this.displayedIndex].style.display = 'none';\n    this.displayedIndex = index;\n    this.settings.callback(index);\n  }\n\n  _addEventHandlers() {\n    var self = this;\n\n    if (/Android|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) &&\n        window.DeviceOrientationEvent !== undefined &&\n        window.orientation !== undefined) {\n\n      window.addEventListener('deviceorientation', function (e) {\n        let imgIdx = 0;\n        let angle = Math.abs(window.orientation) == 90 ? e.beta : e.gamma;\n        if (angle > self.settings.maxAngle) {\n          imgIdx = self.images.length - 1;\n        } else {\n          let regionDegreeWidth = 2 * self.settings.maxAngle / self.images.length,\n              regionStartDegree = -self.settings.maxAngle + regionDegreeWidth;\n          while (true) {\n            if (angle <= regionStartDegree) { break; }\n            regionStartDegree += regionDegreeWidth;\n            imgIdx++;\n          }\n        }\n        self.transitionToImage(imgIdx);\n      });\n      return;\n    }\n\n    this.container.onmousemove = function (e) {\n      let imgIdx = 0,\n          regionWidth = self.settings.width / self.images.length,\n          regionStartX = regionWidth;\n      while (true) {\n        if (e.offsetX <= regionStartX) { break; }\n        regionStartX += regionWidth;\n        imgIdx++;\n      }\n      self.transitionToImage(imgIdx);\n    };\n  }\n\n  run() {\n    if (!this._startImgLoaded) {\n      this._runOnLoad = true;\n      return;\n    }\n\n    this._addEventHandlers();\n\n    this.container.style.height = this.settings.height + 'px';\n    this.container.style.width = this.settings.width + 'px';\n\n    for (let i = 0; i < this.images.length; i++) {\n      this.container.appendChild(this.images[i]);\n    }\n\n    this._setImage(this.settings.startIndex);\n  }\n}\n\nwindow.Swivel = Swivel;\n"]}